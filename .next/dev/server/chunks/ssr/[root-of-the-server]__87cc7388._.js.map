{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/swaggy/Study/SEM-6/AWT/task-path-pal-main%20%282%29/src/integrations/supabase/client.ts"],"sourcesContent":["// This file is automatically generated. Do not edit it directly.\nimport { createClient } from '@supabase/supabase-js';\nimport { Database } from './types';\n\n// Use NEXT_PUBLIC_ prefix for Next.js client-side env vars\n// Fallback to VITE_ vars if NEXT_PUBLIC_ are not set (during migration)\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL || import.meta.env?.VITE_SUPABASE_URL;\nconst SUPABASE_ANON_KEY = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || import.meta.env?.VITE_SUPABASE_ANON_KEY;\n\nif (!SUPABASE_URL || !SUPABASE_ANON_KEY) {\n  console.error('Missing Supabase environment variables');\n}\n\n// Import the supabase client like this:\n// import { supabase } from \"@/integrations/supabase/client\";\n\nexport const supabase = createClient<Database>(SUPABASE_URL || '', SUPABASE_ANON_KEY || '', {\n  auth: {\n    persistSession: true,\n    autoRefreshToken: true,\n  }\n});"],"names":[],"mappings":";;;;AAAA,iEAAiE;AACjE;;;;;;;AAGA,2DAA2D;AAC3D,wEAAwE;AACxE,MAAM,eAAe,gFAAwC,8BAAY,GAAG,EAAE;AAC9E,MAAM,oBAAoB,wPAA6C,8BAAY,GAAG,EAAE;AAExF;;AAOO,MAAM,WAAW,IAAA,8LAAY,EAAW,gBAAgB,IAAI,qBAAqB,IAAI;IAC1F,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;IACpB;AACF"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///home/swaggy/Study/SEM-6/AWT/task-path-pal-main%20%282%29/src/contexts/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport { User, Session } from '@supabase/supabase-js';\nimport { supabase } from '@/integrations/supabase/client';\n\nexport type AppRole = 'admin' | 'hod' | 'technician' | 'requestor';\n\ninterface Profile {\n  id: string;\n  name: string;\n  email: string;\n  avatar_url?: string;\n  department_id?: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  session: Session | null;\n  profile: Profile | null;\n  role: AppRole;\n  isLoading: boolean;\n  signIn: (email: string, password: string) => Promise<{ error: Error | null }>;\n  signUp: (email: string, password: string, name: string) => Promise<{ error: Error | null }>;\n  signOut: () => Promise<void>;\n  hasRole: (requiredRole: AppRole | AppRole[]) => boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [profile, setProfile] = useState<Profile | null>(null);\n  const [role, setRole] = useState<AppRole>('requestor');\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    // Set up auth state listener FIRST\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      (event, currentSession) => {\n        setSession(currentSession);\n        setUser(currentSession?.user ?? null);\n\n        // Defer fetching profile/role to avoid deadlock\n        if (currentSession?.user) {\n          setTimeout(() => {\n            fetchUserData(currentSession.user.id);\n          }, 0);\n        } else {\n          setProfile(null);\n          setRole('requestor');\n          setIsLoading(false);\n        }\n      }\n    );\n\n    // THEN check for existing session\n    supabase.auth.getSession().then(({ data: { session: currentSession } }) => {\n      setSession(currentSession);\n      setUser(currentSession?.user ?? null);\n      if (currentSession?.user) {\n        fetchUserData(currentSession.user.id);\n      } else {\n        setIsLoading(false);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const fetchUserData = async (userId: string) => {\n    try {\n      // Fetch profile\n      const { data: profileData } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', userId)\n        .maybeSingle();\n\n      if (profileData) {\n        setProfile(profileData as Profile);\n      }\n\n      // Fetch role\n      const { data: roleData } = await supabase\n        .from('user_roles')\n        .select('role')\n        .eq('user_id', userId)\n        .maybeSingle();\n\n      if (roleData) {\n        setRole(roleData.role as AppRole);\n      }\n    } catch (error) {\n      console.error('Error fetching user data:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signIn = async (email: string, password: string) => {\n    try {\n      const { error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n      return { error };\n    } catch (error) {\n      return { error: error as Error };\n    }\n  };\n\n  const signUp = async (email: string, password: string, name: string) => {\n    try {\n      const redirectUrl = `${window.location.origin}/`;\n\n      const { error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          emailRedirectTo: redirectUrl,\n          data: {\n            name,\n          },\n        },\n      });\n      return { error };\n    } catch (error) {\n      return { error: error as Error };\n    }\n  };\n\n  const signOut = async () => {\n    await supabase.auth.signOut();\n    setUser(null);\n    setSession(null);\n    setProfile(null);\n    setRole('requestor');\n  };\n\n  const hasRole = (requiredRole: AppRole | AppRole[]) => {\n    if (Array.isArray(requiredRole)) {\n      return requiredRole.includes(role);\n    }\n    return role === requiredRole;\n  };\n\n  return (\n    <AuthContext.Provider value={{\n      user,\n      session,\n      profile,\n      role,\n      isLoading,\n      signIn,\n      signUp,\n      signOut,\n      hasRole\n    }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 184, "column": 0}, "map": {"version":3,"sources":["file:///home/swaggy/Study/SEM-6/AWT/task-path-pal-main%20%282%29/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["file:///home/swaggy/Study/SEM-6/AWT/task-path-pal-main%20%282%29/src/components/ui/tooltip.tsx"],"sourcesContent":["import * as React from \"react\";\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst TooltipProvider = TooltipPrimitive.Provider;\n\nconst Tooltip = TooltipPrimitive.Root;\n\nconst TooltipTrigger = TooltipPrimitive.Trigger;\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className,\n    )}\n    {...props}\n  />\n));\nTooltipContent.displayName = TooltipPrimitive.Content.displayName;\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,kBAAkB,+KAAyB;AAEjD,MAAM,UAAU,2KAAqB;AAErC,MAAM,iBAAiB,8KAAwB;AAE/C,MAAM,+BAAiB,mNAAgB,CAGrC,CAAC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC1C,8OAAC,8KAAwB;QACvB,KAAK;QACL,YAAY;QACZ,WAAW,IAAA,yHAAE,EACX,sYACA;QAED,GAAG,KAAK;;;;;;AAGb,eAAe,WAAW,GAAG,8KAAwB,CAAC,WAAW"}},
    {"offset": {"line": 236, "column": 0}, "map": {"version":3,"sources":["file:///home/swaggy/Study/SEM-6/AWT/task-path-pal-main%20%282%29/src/app/providers.tsx"],"sourcesContent":["\"use client\";\n\nimport { ThemeProvider as NextThemesProvider } from \"next-themes\";\nimport { AuthProvider } from \"@/contexts/AuthContext\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n    return (\n        <NextThemesProvider\n            attribute=\"class\"\n            defaultTheme=\"system\"\n            enableSystem\n            disableTransitionOnChange\n        >\n            <AuthProvider>\n                <TooltipProvider>\n                    {children}\n                </TooltipProvider>\n            </AuthProvider>\n        </NextThemesProvider>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACjE,qBACI,8OAAC,iKAAkB;QACf,WAAU;QACV,cAAa;QACb,YAAY;QACZ,yBAAyB;kBAEzB,cAAA,8OAAC,+IAAY;sBACT,cAAA,8OAAC,sJAAe;0BACX;;;;;;;;;;;;;;;;AAKrB"}}]
}